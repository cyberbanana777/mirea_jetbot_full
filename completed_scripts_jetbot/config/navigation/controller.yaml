controller_server:
  ros__parameters:
    controller_plugins: ["FollowPath"]
    FollowPath:
      plugin: "nav2_regulated_pure_pursuit_controller::RegulatedPurePursuitController"
      lookahead_dist:           0.15
      use_path_orientations:    false
      use_rotate_to_heading:    false

      # --- скорость ---
      desired_linear_vel:       0.08         # м/с
      max_robot_angular_vel:    1.8          # рад/с
      max_angular_accel:        2.0          # рад/с²
      use_velocity_scaled_lookahead_dist: true
      regulate_turning_velocity: true
      
      # — коллизии и замедление —
      use_collision_detection:             true
      max_allowed_time_to_collision_up_to_carrot: 2.0
      cost_scaling_dist:                   0.05   # ≤ inflation_radius
      inflation_cost_scaling_factor:       3.0    # = costmap
      use_cost_regulated_linear_velocity_scaling: true
      use_regulated_linear_velocity_scaling:       true
      
   
local_costmap:
  local_costmap:
    ros__parameters:
      update_frequency: 5.0
      publish_frequency: 1.0
      global_frame: map
      robot_base_frame: base_link
      use_sim_time: False
      rolling_window: true
      width: 3
      height: 3
      resolution: 0.05
      robot_radius: 0.1
      footprint: '[ [0.65, 0.65], [0.65, -0.65], [-0.65, -0.65], [-0.65, 0.65] ]'
      plugins: ["voxel_layer", "inflation_layer"]
      inflation_layer:
        plugin: "nav2_costmap_2d::InflationLayer"
        cost_scaling_factor: 1.5
        inflation_radius: 0.15
      voxel_layer:
        plugin: "nav2_costmap_2d::VoxelLayer"
        enabled: False
        publish_voxel_map: True
        origin_z: 0.0
        z_resolution: 0.05
        z_voxels: 16
        max_obstacle_height: 2.0
        mark_threshold: 0
        observation_sources: scan
        scan:
          topic: /scan
          max_obstacle_height: 2.0
          clearing: False
          marking: True
          data_type: "LaserScan"
          raytrace_max_range: 3.0
          raytrace_min_range: 0.0
          obstacle_max_range: 2.5
          obstacle_min_range: 0.0
      static_layer:
        map_subscribe_transient_local: True
      always_send_full_costmap: True

#   # Not included in course
#   local_costmap_client:
#     ros__parameters:
#       use_sim_time: False
#   local_costmap_rclcpp_node:
#     ros__parameters:
#       use_sim_time: False

#   #Not included in course
# controller_server_rclcpp_node:
#   ros__parameters:
#     use_sim_time: False